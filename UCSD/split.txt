Training (GEPA optimization)
dataset: 5-core
split: Leave-Last-Out per user
filter: users with ≥8 reviews
sample: stratified across categories (N=2000 train) ~28 categories in 5 core
input fields: compact product (title/category/brand/price) + review_excerpt + rating
keep full review stored, excerpt passed to model

Validation
same as training restrictions
N=200 users
used to pick prompt checkpoints / compare variants


Test
same restrictions
N=400 users, fixed
never used for prompt decisions

Generalization
0-core sampled users ≥8 reviews, N=400
report drop in metrics





schema:

{
  "user_id": "U123",
  "category": "All Beauty",
  "interactions": [
    {
      "t": 1700000123,
      "product": {
        "asin": "B01CUPMQZE",
        "title": "Howard LC0008 Leather Conditioner, 8-Ounce (4-Pack)",
        "main_category": "All Beauty",
        "brand": "Howard Products",
        "price": null
      },
      "rating": 5.0,
      "review_full": "Full review text here ...",
      "review_excerpt": "Excerpt text here ...",(High-signal excerpt)
      "review_id": "R987"
    }
  ]
}

Categories: https://huggingface.co/datasets/McAuley-Lab/Amazon-Reviews-2023/tree/main/benchmark/5core/last_out

Example:https://huggingface.co/datasets/McAuley-Lab/Amazon-Reviews-2023/blob/main/benchmark/5core/last_out_w_his/All_Beauty.train.csv

All_Beauty
Toys_and_Games
Cell_Phones_and_Accessories
Industrial_and_Scientific
Gift_Cards
Musical_Instruments
Electronics
Handmade_Products
Arts_Crafts_and_Sewing
Baby_Products
Health_and_Household
Office_Products
Digital_Music
Grocery_and_Gourmet_Food
Sports_and_Outdoors
Home_and_Kitchen
Subscription_Boxes
Tools_and_Home_Improvement
Pet_Supplies
Video_Games
Kindle_Store
Clothing_Shoes_and_Jewelry
Patio_Lawn_and_Garden
Unknown
Books
Automotive
CDs_and_Vinyl
Beauty_and_Personal_Care
Amazon_Fashion
Magazine_Subscriptions
Software
Health_and_Personal_Care
Appliances
Movies_and_TV


user{

  items bought {
    

  }

  reviews for items{



  }
}


USER HISTORY (most recent last):
1 Product: Herbivore - Natural Sea Mist Texturizing Salt Spray (All Beauty) | Brand: HERBIVORE | Price: Unknown
   Rating: 5.0
   Review excerpt: "It smells really good... you need a lot of it... comparing to other brands with yucky chemicals..."

2 Product: ...
   Rating: ...
   Review excerpt: "..."
